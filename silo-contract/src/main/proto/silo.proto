//
// Protocol buffers definition for Silo server
//
syntax = "proto3";

import "google/protobuf/timestamp.proto";

package pt.tecnico.sauron.silo.grpc;


option java_multiple_files = true;


enum Target {
    CAR = 0;
    PERSON = 1;
}

message PingRequest {
    // TODO: Time of request
}

message PingResponse {

}

message ClearRequest {

}

message ClearResponse {

}

message Observation {
    Target target  = 1;
    string id = 2;
    google.protobuf.Timestamp ts = 3;
    string camera_name = 4;
}

message ReportRequest {
    string camera_name = 1;
    repeated Observation observations = 2;
}

message ReportResponse {
    bool success = 1;
}

message CamJoinRequest {
    string camera_name = 1;
    float latitude = 2;
    float longitude = 3;
}

message CamJoinResponse {
    bool success = 1;
}

message CamInfoRequest {
    string camera_name = 1;
};

message CamInfoResponse {
    float latitude = 1;
    float longitude = 3;
};

message TrackRequest {
    Target target = 1;
    string id = 2;
}

message TrackResponse {
    Observation observation = 1;
}

message TrackMatchResponse {
    repeated Observation observations = 1;
}

service Silo {
    rpc cam_info(CamInfoRequest) returns(CamInfoResponse);
    rpc cam_join(CamJoinRequest) returns(CamJoinResponse);
    rpc ctrl_clear(ClearRequest) returns(ClearResponse);
    rpc ctrl_ping(PingRequest) returns(PingResponse);
    rpc report(ReportRequest) returns(ReportResponse);
    rpc track(TrackRequest) returns(TrackResponse);
    rpc trackMatch(TrackRequest) returns(TrackMatchResponse);
}